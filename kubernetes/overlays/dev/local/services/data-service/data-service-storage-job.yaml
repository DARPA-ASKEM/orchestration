apiVersion: batch/v1
kind: Job
metadata:
  name: data-service-storage-job
  labels:
    software.uncharted.terarium/name: data-service-storage-job
    software.uncharted.terarium/component: minio
    software.uncharted.terarium/service: data
    software.uncharted.terarium/part-of: services
spec:
  template:
    spec:
      containers:
        - name: data-service-storage-job
          image: data-service-storage-job-image
          command: ["sh"]
          args:
            - -c
            - /bin/mc alias set minio $MINIO_HOST $MINIO_ACCESS_KEY $MINIO_SECRET_KEY && /bin/mc mb $BUCKET && exit 0
          env:
            - name: MINIO_HOST
              value: http://data-service-storage:9000
            - name: MINIO_ACCESS_KEY
              value: miniouser
            - name: MINIO_SECRET_KEY
              value: miniopass
            - name: BUCKET
              value: minio/askem
      restartPolicy: OnFailure

apiVersion: apps/v1
kind: Deployment
metadata:
  name: keycloak-admin
spec:
  strategy:
    type: RollingUpdate
  template:
    spec:
      containers:
        - name: keycloak-admin
          env:
            - name: JAVA_OPTS
              value: "-Dquarkus.http.host=0.0.0.0 -Djava.util.logging.manager=org.jboss.logmanager.LogManager -Djavax.net.ssl.trustStore=/keystore/cacerts"
            - name: realm
              value: Uncharted
            - name: keycloak-service-url
              value: https://keycloak/
            - name: client-id
              value: app
            - name: oidc-secret
              valueFrom:
                secretKeyRef:
                  name: oidc
                  key: client_secret
            - name: realm-admin
              valueFrom:
                secretKeyRef:
                  name: keycloak-admin-service-account-creds
                  key: username
            - name: password
              valueFrom:
                secretKeyRef:
                  name: keycloak-admin-service-account-creds
                  key: password
          volumeMounts:
            - name: keystore-volume
              mountPath: /keystore
          resources: {}
      volumes:
        - name: keystore-volume
          configMap:
            name: keycloak-keystore
status: {}
